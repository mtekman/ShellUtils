#!/bin/bash
#
#  Git update scripts
#

# Sets temp varaiables that only exist for the same bash session

#alias git="git --ignore-submodules=dirty"
alias gpu="git push -u"
alias gpull="git pull"

alias gcomm="git commit -m"
alias gpuom="gpu origin master"

function gcmd {

	dir=`readlink -f $git_loc/../MAIN_REPOS`
	command="$1"

	base=`pwd`;
	for f in `find $dir -type d -name ".git"`;do 
		cd $f/..;

#		stat=`echo $(git status) | grep -v clean`;
#		[ "$stat" != "" ] &&\
		echo -e "\n--> `dirname $f`:\n" \
		&& $command;

		cd $base;
	done
}

function gstall {
	gcmd "git status"
}

function gpall {
	gcmd "git pull"
}


function git-author {
	[ $# != 1 ] && echo -e "\n\tgit-author <author>\n\n changes the author of previous commits to a new one" && return

	git filter-branch -f --env-filter 'export GIT_COMMITTER_NAME=junta12; export GIT_COMMITTER_EMAIL="junta12"; export GIT_AUTHOR_NAME=junta12; export GIT_AUTHOR_EMAIL=junta12' --tag-name-filter cat -- --branches --tags

	echo "verify local changes, and then update remote via: git push --force --tags origin 'refs/heads/*'"
}
